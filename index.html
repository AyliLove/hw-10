<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments">
      </ul>
      <div class="add-form">
        <input
          type="text"
          class="add-form-name"
          placeholder="Введите ваше имя"
        />
        <textarea
          type="textarea"
          class="add-form-text"
          placeholder="Введите ваш коментарий"
          rows="4"
        ></textarea>
        <div class="add-form-row">
          <button class="add-form-button">Написать</button>
        </div>
      </div>
    </div>
  </body>

  <script>
    const addButton = document.querySelector(".add-form-button");
    const nameInput = document.querySelector(".add-form-name");
    const commentInput = document.querySelector(".add-form-text");
    const commentsList = document.querySelector(".comments");

    const commentsData = [
  {
    id: 1,
    name: 'Глеб Фокин',
    text: 'Это будет первый комментарий на этой странице',
    timestamp: '12.02.22 12:18',
    likes: 3,
    liked: false,
  },
  {
    id: 2,
    name: 'Варвара Н.',
    text: 'Мне нравится как оформлена эта страница! ❤',
    timestamp: '13.02.22 19:22',
    likes: 75,
    liked: false,
  },
];

    function renderComments() {
    commentsList.innerHTML = '';

  commentsData.forEach(comment => {
    const newComment = createNewComment(comment);
    commentsList.appendChild(newComment);
  });
}

  function createNewComment(commentData) {
  const { id, name, text, timestamp, likes, liked } = commentData;
  const commentElement = document.createElement("li");
  commentElement.className = "comment";
  commentElement.dataset.id = id;

  commentElement.innerHTML = `
    <div class="comment-header">
      <div>${name}</div>
      <div>${timestamp}</div>
    </div>
    <div class="comment-body">
      <div class="comment-text">${text}</div>
    </div>
    <div class="comment-footer">
      <div class="likes">
        <span class="likes-counter">${likes}</span>
        <button class="like-button${liked ? ' -active-like' : ''}"></button>
      </div>
    </div>
  `;

  // Обработчик для кнопки лайка
  const likeButton = commentElement.querySelector('.like-button');
  likeButton.addEventListener('click', () => {
    toggleLike(id);
  });

  return commentElement;
}

function toggleLike(commentId) {
  const foundComment = commentsData.find(comment => comment.id === commentId);

  if (foundComment) {
    foundComment.liked = !foundComment.liked;
    foundComment.likes = foundComment.liked
      ? foundComment.likes + 1
      : foundComment.likes - 1;

    renderComments();
  }
}

function validateFields(name, text) {
  if (name.trim() === "" || text.trim() === "") {
    return false;
  }
  return true;
}

addButton.addEventListener("click", () => {
  const name = nameInput.value;
  const text = commentInput.value;

  if (!validateFields(name, text)) {
    alert("Пожалуйста, заполните все поля");
    return;
  }

  const id = Math.max(...commentsData.map(comment => comment.id)) + 1;
  const timestamp = new Date().toLocaleString();
  const newCommentData = { id, name, text, timestamp, likes: 0, liked: false };

  commentsData.push(newCommentData);

  renderComments();

  nameInput.value = "";
  commentInput.value = "";
});

renderComments();
  </script>
</html>
